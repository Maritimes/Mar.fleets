--By plopping a known list of accepted VRs from a fleet into this SQL, we get the associated licence types and subtypes
SELECT distinct licence_type, licence_subtype,  gear, species , licence_type_id, licence_subtype_id, gear_code,  species_code
FROM MARFISSCI.marbycatch_lic WHERE
--LICENCE_ID IN (
--003960,027120,008453,008110,024618,007227,003542,304884,003830,027033,004591,004552,005105,005760,
--005838,304885,008622,008837,009496,010081,010565,010622,304971,011084,014175,004922,018201,019583,
--007834,021243,304493,027231,304491,304492,304494,304886,305044,005718,010577,024825,109420,109424,
--109428,109438,109441,109442,109443,109444,109445,109446,109447,109448,109449,109450,109451,109452,
--142645,109277,109287,109289,109292,109297,109314,304223,305932,306243,307366,307836,311569,318716,
--318794,318834,318895,319084,320354,322455,322476,322477,322542,323316,325821,327896,331776,332877,
--333213,334816,335456,336198,342230,344288,345748,346229,347570,349832,350129,016476,024746,024759,
--004743,010417,307817,307818,307821,307822,700032,700071,700081,700082,700084,109413,109414,109415,
--109416,109417,109418,109419,109421,109422,109423,109425,109426,109427,109429,109432,109433,109434,
--109435,109436,109437,109439,109440,339043,140564,140585,334136
--)
--AND
species_code = 254
--AND GEAR_CODE NOT IN (19)
ORDER BY GEAR_CODE,licence_type_id, licence_subtype_id;


SELECT distinct licence_id, licence_type, licence_type_id, licence_subtype, gear_code, licence_subtype_id, species_code, species
FROM MARFISSCI.marbycatch_lic WHERE LICENCE_ID IN (
102663, 102727, 102789, 102897, 142074, 142075, 142076, 142077, 142327, 142514, 318054, 322474, 700065
);

--using trip_id
SELECT  licence_type, licence_subtype,  gear, species , licence_type_id, licence_subtype_id, gear_code,  species_code, COUNT(LICENCE_ID) cnt
FROM MARFISSCI.marbycatch_lic WHERE LICENCE_ID IN (
    SELECT DISTINCT LICENCE_ID FROM PRO_SPC_INFO WHERE TRIP_ID IN (
    SELECT DISTINCT TRIP_ID FROM BFT_LOGS WHERE SUBSTR(DATE_SAILED, 1,4)>2015
)
)
GROUP BY licence_type, licence_subtype,  gear, species , licence_type_id, licence_subtype_id, gear_code,  species_code

AND GEAR_CODE NOT IN (10,12)
AND SPECIES_CODE = 199
ORDER BY licence_type_id, licence_subtype_id, GEAR_CODE


SELECT distinct --licence_type, licence_subtype,  gear, species ,
licence_type_id, licence_subtype_id, gear_code,  species_code
FROM MARFISSCI.marbycatch_lic WHERE LICENCE_ID IN (
SELECT DISTINCT LICENCE_ID FROM PRO_SPC_INFO WHERE SPECIES_CODE IN (102, 110, 170) --AND EXTRACT(YEAR FROM LANDED_DATE)>2015
) AND SPECIES_CODE = 199

ORDER BY licence_type_id, licence_subtype_id, GEAR_CODE


SELECT distinct species , gear,  licence_type, licence_subtype,
species_code,   gear_code,  licence_type_id, licence_subtype_id
FROM MARFISSCI.marbycatch_lic WHERE LICENCE_ID IN (
SELECT DISTINCT LICENCE_ID FROM PRO_SPC_INFO WHERE SPECIES_CODE IN (254) --AND EXTRACT(YEAR FROM LANDED_DATE)>2015
)

ORDER BY species, gear, licence_type_id, licence_subtype_id
